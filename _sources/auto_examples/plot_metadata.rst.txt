.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download_auto_examples_plot_metadata.py>`     to download the full example code or to run this example in your browser via Binder
    .. rst-class:: sphx-glr-example-title

    .. _sphx_glr_auto_examples_plot_metadata.py:


Metadata
========

.. index:: metadata

ONNX format contains metadata related to how the
model was produced. It is useful when the model
is deployed to production to keep track of which
instance was used at a specific time.
Let's see how to do that with a simple
logistic regression model trained with
*scikit-learn*.


.. code-block:: default


    import skl2onnx
    import sklearn
    import numpy
    from onnxruntime import InferenceSession, __version__ as ort_version
    import onnx
    from onnxruntime.datasets import get_example

    example = get_example("logreg_iris.onnx")

    model = onnx.load(example)

    print("doc_string={}".format(model.doc_string))
    print("domain={}".format(model.domain))
    print("ir_version={}".format(model.ir_version))
    print("metadata_props={}".format(model.metadata_props))
    print("model_version={}".format(model.model_version))
    print("producer_name={}".format(model.producer_name))
    print("producer_version={}".format(model.producer_version))





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    doc_string=
    domain=onnxml
    ir_version=3
    metadata_props=[]
    model_version=0
    producer_name=OnnxMLTools
    producer_version=1.2.0.0116




With *ONNX Runtime*:


.. code-block:: default


    sess = InferenceSession(example)
    meta = sess.get_modelmeta()

    print("custom_metadata_map={}".format(meta.custom_metadata_map))
    print("description={}".format(meta.description))
    print("domain={}".format(meta.domain))
    print("graph_name={}".format(meta.graph_name))
    print("producer_name={}".format(meta.producer_name))
    print("version={}".format(meta.version))





.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    custom_metadata_map={}
    description=
    domain=onnxml
    graph_name=3c59201b940f410fa29dc71ea9d5767d
    producer_name=OnnxMLTools
    version=0




**Versions used for this example**


.. code-block:: default


    print("numpy:", numpy.__version__)
    print("scikit-learn:", sklearn.__version__)
    print("onnx: ", onnx.__version__)
    print("onnxruntime: ", ort_version)
    print("skl2onnx: ", skl2onnx.__version__)




.. rst-class:: sphx-glr-script-out

 Out:

 .. code-block:: none

    numpy: 1.19.1
    scikit-learn: 0.23.2
    onnx:  1.7.0
    onnxruntime:  1.4.0
    skl2onnx:  1.7.1





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  0.003 seconds)


.. _sphx_glr_download_auto_examples_plot_metadata.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example


  .. container:: binder-badge

    .. image:: /../../cus/lib/python3.7/site-packages/sphinx_gallery/_static/binder_badge_logo.svg
      :target: https://mybinder.org/v2/gh/microsoft/skl2onnx/master?urlpath=lab/tree/notebooks/auto_examples/plot_metadata.ipynb
      :width: 150 px


  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_metadata.py <plot_metadata.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_metadata.ipynb <plot_metadata.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
