
<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Converters with options &#8212; sklearn-onnx 1.6.0 documentation</title>
    <link rel="stylesheet" href="_static/readable.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Supported scikit-learn Models" href="supported.html" />
    <link rel="prev" title="Convert a pipeline" href="pipeline.html" />
   
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head><body>
  
  

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="supported.html" title="Supported scikit-learn Models"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="pipeline.html" title="Convert a pipeline"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">sklearn-onnx 1.6.0 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="converters-with-options">
<span id="l-conv-options"></span><h1>Converters with options<a class="headerlink" href="#converters-with-options" title="Permalink to this headline">¶</a></h1>
<p>Most of the converters always produce the same converted model
which computes the same outputs as the original model.
However, some of them do not and the user may need to alter the
conversion by giving additional information to the converter.
Below is the list of converters which enable this mechanism.</p>
<dl class="function">
<dt id="skl2onnx.operator_converters.text_vectoriser.convert_sklearn_text_vectorizer">
<code class="sig-prename descclassname">skl2onnx.operator_converters.text_vectoriser.</code><code class="sig-name descname">convert_sklearn_text_vectorizer</code><span class="sig-paren">(</span><em class="sig-param">scope</em>, <em class="sig-param">operator</em>, <em class="sig-param">container</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/skl2onnx/operator_converters/text_vectoriser.html#convert_sklearn_text_vectorizer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#skl2onnx.operator_converters.text_vectoriser.convert_sklearn_text_vectorizer" title="Permalink to this definition">¶</a></dt>
<dd><p>Converters for class
<a class="reference external" href="https://scikit-learn.org/stable/modules/generated/sklearn.feature_extraction.text.TfidfVectorizer.html">TfidfVectorizer</a>.
The current implementation is a work in progress and the ONNX version
does not produce the exact same results. The converter lets the user
change some of its parameters.</p>
<dl class="simple">
<dt>tokenexp: string</dt><dd><p>The default will change to true in version 1.6.0.
The tokenizer splits into words using this regular
expression or the regular expression specified by
<em>scikit-learn</em> is the value is an empty string.
See also note below.
Default value: None</p>
</dd>
<dt>separators: list of separators</dt><dd><p>These separators are used to split a string into words.
Options <em>separators</em> is ignore if options <em>tokenexp</em> is not None.
Default value: <code class="docutils literal notranslate"><span class="pre">['</span> <span class="pre">',</span> <span class="pre">'[.]',</span> <span class="pre">'\\?',</span> <span class="pre">',',</span> <span class="pre">';',</span> <span class="pre">':',</span> <span class="pre">'\\!']</span></code>.</p>
</dd>
</dl>
<p>Example (from <a class="reference internal" href="auto_examples/plot_tfidfvectorizer.html#l-example-tfidfvectorizer"><span class="std std-ref">TfIdfVectorizer with ONNX</span></a>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">seps</span> <span class="o">=</span> <span class="p">{</span><span class="n">TfidfVectorizer</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;separators&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;[.]&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">?&#39;</span><span class="p">,</span> <span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;:&#39;</span><span class="p">,</span> <span class="s1">&#39;!&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">(&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">)&#39;</span><span class="p">,</span>
                                         <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\\</span><span class="s1">&quot;&#39;</span><span class="p">,</span> <span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;-&quot;</span><span class="p">,</span>
                                         <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">[&quot;</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\\</span><span class="s2">]&quot;</span><span class="p">,</span> <span class="s2">&quot;@&quot;</span><span class="p">]}}</span>
<span class="n">model_onnx</span> <span class="o">=</span> <span class="n">convert_sklearn</span><span class="p">(</span><span class="n">pipeline</span><span class="p">,</span> <span class="s2">&quot;tfidf&quot;</span><span class="p">,</span>
                             <span class="n">initial_types</span><span class="o">=</span><span class="p">[(</span><span class="s2">&quot;input&quot;</span><span class="p">,</span> <span class="n">StringTensorType</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="mi">2</span><span class="p">]))],</span>
                             <span class="n">options</span><span class="o">=</span><span class="n">seps</span><span class="p">)</span>
</pre></div>
</div>
<p>The default regular expression of the tokenizer is <code class="docutils literal notranslate"><span class="pre">(?u)\\b\\w\\w+\\b</span></code>
(see <a class="reference external" href="https://docs.python.org/3/library/re.html">re</a>).
This expression may not supported by the library handling the backend.
<a class="reference external" href="https://github.com/Microsoft/onnxruntime">onnxruntime</a> uses
<a class="reference external" href="https://github.com/google/re2">re2</a>. You may need to switch
to a custom tokenizer based on
<cite>python wrapper for re2 &lt;https://pypi.org/project/re2/&gt;_</cite>
or its sources <a class="reference external" href="https://github.com/facebook/pyre2">pyre2</a>
(<a class="reference external" href="https://github.com/google/re2/blob/master/doc/syntax.txt">syntax</a>).
If the regular expression is not specified and if
the instance of TfidfVectorizer is using the default
pattern <code class="docutils literal notranslate"><span class="pre">(?u)\\b\\w\\w+\\b</span></code>, it is replaced by
<code class="docutils literal notranslate"><span class="pre">[a-zA-Z0-9_]+</span></code>. Any other case has to be
manually handled.</p>
<p>Regular expression <code class="docutils literal notranslate"><span class="pre">[^\\\\n]</span></code> is used to split
a sentance into character (and not works) if <code class="docutils literal notranslate"><span class="pre">analyser=='char'</span></code>.
The mode <code class="docutils literal notranslate"><span class="pre">analyser=='char_wb'</span></code> is not implemented.</p>
<div class="versionchanged">
<p><span class="versionmodified changed">Changed in version 1.6: </span>Parameters have been renamed: <em>sep</em> into <em>separators</em>,
<em>regex</em> into <em>tokenexp</em>.</p>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/logo_main.png" alt="Logo"/>
            </a></p><h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation index</a><ul>
      <li>Previous: <a href="pipeline.html" title="previous chapter">Convert a pipeline</a></li>
      <li>Next: <a href="supported.html" title="next chapter">Supported scikit-learn Models</a></li>
  </ul></li>
</ul>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/parameterized.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
  <div class="footer">
    &copy; Copyright 2018-2019, Microsoft.
    Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.2.1.
  </div>
  
  </body>
</html>